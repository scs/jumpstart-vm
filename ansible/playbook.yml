- hosts: all

  pre_tasks:
  - include_tasks: tasks/ubuntu_apt.yml
  - include_tasks: tasks/ubuntu_desktop.yml
  - include_tasks: tasks/virtualbox_additions.yml
  - include_tasks: tasks/basicsetup.yml
  - include_tasks: tasks/buildtools.yml
  - include_tasks: tasks/java.yml

  roles:
  - role: ssh
    vars:
      ssh_pub_files: ['ssh_key_clang_home.opub', 'rsa-key-clang-scs-20170919.opub']

  - role: swapfile
    vars:
      swapfile_size: 4G

  - role: ansible-role-samba
    become: true
    vars:
      samba_mitigate_cve_2017_7494: false
      samba_users:
        - name: '{{ ansible_env.USER }}'
          password: '{{ ansible_env.USER }}'
      samba_shares:
        - name: vagrant-home
          path: '{{ ansible_env.HOME }}'
          browseable: true
          owner: '{{ ansible_env.USER }}'
          group: '{{ ansible_env.USER }}'
          valid_users: '{{ ansible_env.USER }}'
          write_list: '{{ ansible_env.USER }}'

  - role: bash
  - role: tmux
  - role: clion

  - role: git-tools
    vars:
      git_aliases: true
      git_rerere: true
      git_editor_nano: true
      git_prompt: true
      git_archivestotext: true
      git_docxtotext: true
      git_pdftotext: true
      git_xlsxtotext: true
      git_user_name: "Hans Jumpstart"
      git_user_email: "jumpstart@jumpstart.com"

  - role: docker
#  - role: ansible-role-docmake
#    vars:
#      pandoc: true
#      texlive_min: true
#      texlive_additional: true
#      markdownlint: true
#      drawio: true
#      gpp: true
#      metropolis: true
#      tikz_uml: true
#      docmake_version: '35411f1'
  - role: okular

  - role: ansible-role-intellij
    vars:
      intellij_version: '2021.3.1'
      intellij_edition: 'community'
      users:
        - username: '{{ ansible_env.USER }}'
          intellij_jdks:
            - name: '11'
              home: '{{ jdk11_home }}'
          intellij_default_jdk: '11'
          intellij_disabled_plugins:
            - org.jetbrains.plugins.gradle
            - CVS
            - com.intellij.uiDesigner
            - org.jetbrains.android
            - TestNG-J
            - hg4idea
            - Subversion
            - AntSupport
            - DevKit
            - Kotlin

  - role: ansible-role-visual-studio-code

  post_tasks:
    - include_tasks: tasks/intellij.yml
    - include_tasks: tasks/ubuntu_cleanup.yml
